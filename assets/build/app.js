angular.module("baseData",[]).factory("baseData",function(){return OffenerHaushalt});var offenerhaushalt=angular.module("offenerhaushalt",["ngAnimate","baseData"]);offenerhaushalt.config(["$compileProvider",function(e){e.debugInfoEnabled(false)}]);offenerhaushalt.controller("AppController",["$scope","$rootScope","$http","$location",function(e,t,o,a){}]);offenerhaushalt.controller("HomeController",["$scope","baseData",function(e,t){e.state={};var o=document.querySelectorAll("#map")[0],a=o.clientWidth,l=o.clientHeight;var n=d3.geo.path(),r=d3.select("#map").append("svg").attr("width",a).attr("height",l),s=null;var i=function(o){var a=o||{};a.budgets=[];for(var l in t.budgets){var n=t.budgets[l];if(n.state==a.code){a.budgets.push(n)}}e.state=a;e.$apply()};d3.json("/assets/img/deu.topo.json",function(e,t){var o=topojson.feature(t,t.objects.deu);var n=d3.geo.mercator().center([10.5,51.35]).scale(2500).translate([a/2,l/2]);var u=d3.geo.path().projection(n);r.selectAll(".subunit").data(o.features).enter().append("path").attr("class",function(e){return"subunit "+e.properties.code}).attr("d",u).on("mouseover",function(e){if(e.properties.code!=s){d3.select(this).transition().duration(200).style({fill:"#333"})}if(s===null){i(e.properties)}}).on("mouseout",function(e){if(e.properties.code!=s){d3.select(this).transition().duration(500).style({fill:"#555"})}if(s===null){i(null)}}).on("click",function(e){if(e.properties.code==s){s=null;i(null);d3.selectAll(".subunit").style({fill:"#555"})}else{s=e.properties.code;i(e.properties);d3.selectAll(".subunit").style({fill:"#555"});d3.select(this).style({fill:"#42928F"})}}).transition().duration(400).style("fill","#555")})}]);offenerhaushalt.controller("BudgetController",["$scope","$http","$q","baseData",function(e,t,o,a){var l=a.budgets[a.currentBudget],n=a.apiUrl+l.dataset;t.get(n+"/model").then(function(a){l.model=a.data;var r=[];for(var s in l.filters){var i=l.filters[s];r.push(t.get(n+"/members/"+i.field))}o.all(r).then(function(t){for(var o in l.filters){l.filters[o].values=t[o].data.data}e.budget=l;console.log(e.budget)})})}]);